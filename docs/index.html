<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Applying to Graduate School in Ecology, Evolution, and Related Fields</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Applying to Graduate School in Ecology, Evolution, and Related Fields</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#still-in-development-oct-3-2024" id="toc-still-in-development-oct-3-2024" class="nav-link active" data-scroll-target="#still-in-development-oct-3-2024"><em>STILL IN DEVELOPMENT, Oct 3, 2024</em></a>
  <ul class="collapse">
  <li><a href="#what-is-graduate-school" id="toc-what-is-graduate-school" class="nav-link" data-scroll-target="#what-is-graduate-school">What is graduate school?</a></li>
  <li><a href="#how-much-does-it-cost" id="toc-how-much-does-it-cost" class="nav-link" data-scroll-target="#how-much-does-it-cost">How much does it cost?</a></li>
  <li><a href="#what-is-the-timeline" id="toc-what-is-the-timeline" class="nav-link" data-scroll-target="#what-is-the-timeline">What is the timeline?</a></li>
  <li><a href="#how-to-pick-where-to-apply" id="toc-how-to-pick-where-to-apply" class="nav-link" data-scroll-target="#how-to-pick-where-to-apply">How to pick where to apply?</a></li>
  <li><a href="#mental-health-in-grad-school" id="toc-mental-health-in-grad-school" class="nav-link" data-scroll-target="#mental-health-in-grad-school">Mental health in grad school</a></li>
  <li><a href="#do-i-need-to-take-the-gre" id="toc-do-i-need-to-take-the-gre" class="nav-link" data-scroll-target="#do-i-need-to-take-the-gre">Do I need to take the GRE?</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Applying to Graduate School in Ecology, Evolution, and Related Fields</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="still-in-development-oct-3-2024" class="level1">
<h1><em>STILL IN DEVELOPMENT, Oct 3, 2024</em></h1>
<p>This page has info on how to apply to ecology, evolutionary biology, behavior, and related fields for graduate school. Our focus is the US. The goal is to expose some of the “hidden curriculum” – some of the information that some people know (for example, if their parents are professors) but might not invisible to those with different backgrounds. Note our potential conflicts of interest as faculty who mentor grad students and also serve on an admissions committee: we could inadvertently be painting a too positive picture of the process. There can also be substantial differences across fields: some of this could apply to a PhD program in history, for example, but some might be terrible. We also come with particular backgrounds, perspectives, and experiences: they might not match your experience or predict how things will work out for you. Searching for “hidden curriculum” and “graduate school” will bring up many more resources.</p>
<section id="what-is-graduate-school" class="level2">
<h2 class="anchored" data-anchor-id="what-is-graduate-school">What is graduate school?</h2>
<p>Graduate school is where you study for a Masters or PhD. In ecology and evolutionary biology (EEB), a Masters can be coursework-based (like most bachelors degrees: take this many classes, have a high enough average, get a degree) or research-based (like a PhD, but shorter and with less research). A PhD is a research degree: you do a lot of research, write a dissertation, and defend it. You also take classes, but the focus is on research. A Masters degree typically takes 2-3 years, a PhD 5-6 years. Sometimes people get a Masters degree while on the way to a PhD; sometimes they get a Masters at one institution and a PhD at another; sometimes they go directly from undergrad to a PhD program.</p>
</section>
<section id="how-much-does-it-cost" class="level2">
<h2 class="anchored" data-anchor-id="how-much-does-it-cost">How much does it cost?</h2>
<p>Coursework-based Masters, especially if the target audience is professionals who need a degree for professional development, will usually cost tuition. Research-based Masters, and PhD programs, <strong>actually pay you to go</strong>. Technically, this is usually pay for teaching (as a teaching assistant, or “TA” or “GTA”) and/or for doing funded research (a research assistant, an “RA” or “GRA” [not “RA” as in “resident advisor”, a person who helps students staying in dorms]). This usually covers tuition, a modest stipend, and enrolls you in a healthcare program. It may or may not cover fees, which can sometimes be substantial. <a href="PhDStipends.com">https://www.phdstipends.com</a> has crowd-sourced information on stipends PhD students a paid in different schools and programs so you can get a sense of the range of values; most programs will also put their base stipend on their websites. Note that the stipends on PhDStipends.com might include bonus fellowships, or might be for students on research assistantships where the base pay is higher (because that is how the grant budget is written) – you might get a different amount. Stipends in EEB might be as low as $20,000 but go as high as $45,000 or more. However, cost of living can vary dramatically, as well: a moderate stipend in one place might allow grad students to buy a house, while in another a higher stipend might still require multiple roommates in a small apartment. One useful website is <a href="https://livingwage.mit.edu" class="uri">https://livingwage.mit.edu</a>, which calculates living wage in various places: you can multiply the hourly living wage by 2080 to get the annual living wage. For example, as of when our website was last updated, the living wage in Cambridge, MA, was $30.04 (so annual cost of $62,483) while the county containing Oxford, MS was $21.95 (annual cost of $45,656).</p>
<p>Healthcare in the US is also a varied system. Eyes and dental care are treated separately from the rest of the body (and often are not covered by default), having a dependent spouse and/or children are additional costs, and there may be different deductibles and copays for treatment. You should be able to get details of what is included and costs when you get an offer of admission.</p>
<p>Note that in most cases, the offer of admission and offer of support (as a TA and RA) come in together, but you could in most cases choose to separate them (though some programs do require teaching a semester or two). For example, if you happen to be wealthy, you could choose to pay your own tuition and not take a TA position. This is very rare.</p>
</section>
<section id="what-is-the-timeline" class="level2">
<h2 class="anchored" data-anchor-id="what-is-the-timeline">What is the timeline?</h2>
<p>Most programs start in the Fall (which can be as early as August). The process to get into grad school starts nearly a full year before this:</p>
<ul>
<li>September-October a year before the start: start contacting potential mentors. Also look to see if things like the GRE are required.</li>
<li>By October: consider applying for the <a href="https://www.nsfgrfp.org">NSF Graduate Research Fellowship Program</a> (GRFP). A two page research proposal, three page personal statement, letters of rec and some similar materials, and you have a <strong>chance to get three years of funding for grad school</strong>. Check for the deadlines (they are very strict) and eligibility (you can only apply twice, and only if you are a US citizen or permanent resident).</li>
<li>By December (but check to make sure no earlier deadlines): Formally apply to programs. Make sure you have strong letters of rec lined up.</li>
<li>January-February: Interviews. Some programs will fly you out (they pay, usually) to visit the campus and meet with faculty and students, some will do this virtually, and some will not do this at all. These visits can be very informative; just remember that they are evaluating you while you are evaluating them. Are you curious? Will you work hard?</li>
<li>January-March: Offers of admission. You might get an unofficial offer, but check to see what your official offer letter includes (often details of funding).</li>
<li>April 15: Deadline to respond to offers of financial support, for all universities signed onto the <a href="https://cgsnet.org/resources/for-current-prospective-graduate-students/april-15-resolution">April 15 Resolution</a>. This keeps universities from using high pressure tactics to get you to commit before other offers come in. That said, if you get an offer before this you definitely will not accept (i.e., if you already have a better offer from another school, but are waiting to hear from more), it is kind to let the school know so they can offer the spot to someone else. If a university is giving you a deadline before April 15, that is a warning sign about that institution.</li>
<li>April-August: New offers might still go out as people decline offers, perhaps other students graduate earlier than expected, etc. So if you have not gotten an offer by mid-April, it still might be possible, though less likely.</li>
</ul>
<p>Watch for when your program expects you to start: they might have training before the semester starts. Note that in the US rentals typically require first and last month rent, plus a security deposit before you can move in; often universities will not start paying you until two or four weeks after you begin working (but fees, including for parking, might be due on the first day of the semester).</p>
</section>
<section id="how-to-pick-where-to-apply" class="level2">
<h2 class="anchored" data-anchor-id="how-to-pick-where-to-apply">How to pick where to apply?</h2>
<p>There is a lot of pressure to rank colleges for undergraduate programs: there are companies that make a lot of their money comparing different colleges, and there have even been <a href="https://www.cnn.com/2022/09/22/opinions/columbia-ranking-inaccurate-data-thaddeus/index.html">allegations</a> of cheating by colleges. It is a big deal if a college drops or rises multiple places on the <em>US News</em> ranking, for example. Going to a “top” college has a cachet that draws students and arguably has a major impact on future career options.</p>
<p>Some groups do attempt to rank graduate programs in the same way, but they have much less impact. For one thing, it is hard to compare programs: how does a general biology program with faculty ranging from cell biology to pesticide development to fish anatomy compare to a specialized botany program? For another, the mentor matters a lot more to peers than the college. For undergrad, you might hear “I studied at”U. of Foo” but for grad school you are more likely to hear “My advisor was Dr.&nbsp;Smith.” Small sample size can also be a big issue: a set of three or four faculty in an area can make that school a “powerhouse” in that area – when two move away, the program changes a lot.</p>
<p><strong>So the first question to ask is, “Who do I want as an advisor?”</strong> <em>Then</em> see if the program, location, and more can work for you.</p>
<p>In EEB it’s most common to first identify one or two mentors in a program and join their lab directly (while still being admitted to a program overall). Some programs, especially more general biology programs, have rotations where students work for a substantial period of time in different labs before an advisor is identified. In either case, it is still good to reach out to potential mentors early (and try them again if at first you do not get a reply: often they are in the field or otherwise inaccessible).</p>
</section>
<section id="mental-health-in-grad-school" class="level2">
<h2 class="anchored" data-anchor-id="mental-health-in-grad-school">Mental health in grad school</h2>
<p>Studies show grad school can be terrible for mental health. This does not mean people facing mental health challenges should avoid grad school, but it does mean that everyone should be aware of risks and consider strategies to mitigate them. Programs and mentors should be addressing these, as well – some are, others not so much.</p>
</section>
<section id="do-i-need-to-take-the-gre" class="level2">
<h2 class="anchored" data-anchor-id="do-i-need-to-take-the-gre">Do I need to take the GRE?</h2>
<p>The GRE is a standardized test that was once a common requirement for applicants to graduate school. It tests for <a href="https://www.ets.org/gre/test-takers/general-test/prepare/content/quantitative-reasoning.html">high school level math and stats</a>, including understanding of even and odd numbers, perimeter of shapes, reading bar charts, and more; <a href="https://www.ets.org/gre/test-takers/general-test/prepare/content/verbal-reasoning.html">verbal reasoning</a> including reading comprehension and completing text; and <a href="https://www.ets.org/gre/test-takers/general-test/prepare/content/analytical-writing.html">analytical writing</a>. It is over $200, but some student in the US can get a discount to $100 (I could not find out information on international fee reductions). There are also subject tests.</p>
<p>Most programs have eliminated it in admissions: see <a href="https://www.science.org/content/article/gre-exit-gains-momentum-ph-d-programs-drop-exam-requirement-amid-pandemic">Langin (2022)</a>. Its expense serves as a barrier to many students, and the information it purports to predict, grades in grad school, are not generally a major factor in research-based graduate programs. However, do check if the programs you are considering do still require it.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>